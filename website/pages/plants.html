<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plants</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/plants.css">
    <link rel="stylesheet" href="../css/theme.css">
    <script src="https://cdn.plot.ly/plotly-3.0.1.min.js"></script>
    <script src="../js/plant-generator.js" defer></script>
    <script src="../js/moisture-display.js" defer></script>
    <script src="../js/toc.js" defer></script>
</head>
<body>
    <header>
        <div class="header-content">
            <nav>
                <ul>
                    <li><a href="../index.html">Home</a></li>
                    <li><a href="plants.html" class="active">Plants</a></li>
                    <li><a href="info.html">Info</a></li>
                    <li><a href="crab-rave.html">Rave</a></li>
                </ul>
            </nav>
        </div>
    </header>
    <div class="container">
        <main>
            <h1>Plants</h1>
            <p>Below are the current moisture readings for each plant in the house. Values are updated approximately every hour, while data is taken about every minute. When updated, the average of all values in the previous hour is computed and uploaded here.</p>
            
            <!-- Plant cards will be dynamically generated here -->
        </main>
    </div>
    
    <script>
        // Initialize the page with dynamic content
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                // Generate plant cards from configuration
                await initializeDynamicPlants();
                
                // Initialize moisture display functionality
                await initializeApp();
                
                // Update copyright year
                const copyrightYear = document.getElementById('copyright-year');
                if (copyrightYear) {
                    copyrightYear.textContent = new Date().getFullYear();
                }
            } catch (error) {
                console.error('Failed to initialize plants page:', error);
                // Show error message to user
                const main = document.querySelector('main');
                const errorDiv = document.createElement('div');
                errorDiv.style.color = 'red';
                errorDiv.style.padding = '20px';
                errorDiv.style.border = '1px solid red';
                errorDiv.style.borderRadius = '5px';
                errorDiv.style.margin = '20px 0';
                errorDiv.innerHTML = '<strong>Error:</strong> Failed to load plant configuration. Please refresh the page.';
                main.appendChild(errorDiv);
            }
        });
    </script>
</body>
</html>
